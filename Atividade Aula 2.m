%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 0 - Boas prÃ¡ticas%%clc;clear all;close all;%%% carregando o pacote de controle e sinaispkg load control;pkg load signal;%%% dados = load("-ascii", "exp7.txt");%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 1 - Leitura e investigação dos dados%%%% coluna 3 se refere a entradadados = load("-ascii", "exp7.txt");%% Renomeando as colunasentrada = dados(:,3); # Entrada aplicada ao motorvelocidade = dados(:,1); # Entrada aplicada ao motorposicao = dados(:,2); # Entrada aplicada ao motor%% Criando o vetor tempoNp = length(entrada); %Numero de pontos coletadosTs = 1e-3; %Tempo de amostragemtempo = [0:Ts:(Np-1)*Ts]; % Vetor tempo%% Visualização dos dadosfigure(1)subplot(3,1,1);plot(tempo,entrada(1:end), 'linewidth', 3);grid;title('Entrada');xlabel('Tempo em segundos');ylabel('Tensao');subplot(3,1,2);plot(tempo,velocidade(1:end), 'linewidth', 3);grid;title('Velocidade');xlabel('Tempo em segundos');ylabel('Tensao');subplot(3,1,3);plot(tempo,posicao(1:end), 'linewidth', 3);grid;title('Posicao');xlabel('Tempo em segundos');ylabel('Tensao');%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 2 - Qual a função de transferência em Laplace que relaciona a entrada %%     e a velocidade? Gm(s) = Nm(s)/Dm(s)%%%%     Plotar de froma sobreposta os dados (real) e o modelo matemático%%%% Polo e ganho -->  Gm(s) = ganho/ (s+polo) --> primeira ordemp = 1; %polo do sistemaganho = 1; %ganho do sistema%%% quanto maior o valor do polo mais rápido o sistema éNm = ganho; %numerador da funcao de laplaceDm = [1 p]; %denominador de laplaceGm = tf(Nm,Dm); %Funcao de transferencia-->modelo matematico% Visualizar o resultado do modelo comparado aos dadosSYS = Gm; %Sitema a ser simuladoU = entrada; %Entrada do sistemaT = tempo; %Vetor tempo%%% ym - saida e CI - condicao inicial[ym, T, CI] = lsim(SYS, U, T);%% Calculo do erro quadraticoErro = sum((ym - velocidade).^2)%% Visualizacaofigure(2)plot(tempo,velocidade(1:end), 'linewidth', 3);grid;hold;plot(tempo,ym,'linewidth', 3)title('Dados e resposta do modelo');xlabel('Tempo em segundos');ylabel('Tensao');  %%%Varia o valor do polopolo = [1:1:100];for n = 1:100    Nm = ganho; % numerador da função de laplace  Dm = [1 polo(n)]; % denominador de laplace%%% Função de transferência - modelo matemático  Gm = tf(Nm,Dm);  %%% Visualizar o resultado do modelo comparado aos dadosSYS = Gm;                       % sistema a ser simuladoU   = entrada;                  % entrada do sistemaT   = tempo;                    % vetor tempo%%%% ym - saída%%%%%% CI - condição inicial[ym, T, CI] = lsim (SYS, U, T);%%% Calculando o erro quadráticoErro(n) = sum((ym - velocidade).^2);end%Grafico do erro e polofigure(3)plot(polo,Erro,'linewidth', 3)